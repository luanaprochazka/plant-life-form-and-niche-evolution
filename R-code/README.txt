##  DESCRIPTION R CODE FILES AND RUN INSTRUCTION:

Scripts in this folder are arranged in ascending order. This way, the files generated in the first script will be used in subsequent scripts and so on. However, we provide all .csv or .RDS files are generated by the code so that users can run the files in any order.

The files needed to run the  R scripts are available in the "data" or "Results" folders.

In the "data" folder are the primary files, e.g. the first files used to run scripts. The environmental layers and the ecological niche models maps are big files, so we are not sending these files in the "data" folder. These files are needed to run scripts 1 and 2. You can access the files generated by scripts 1 and 2 in the "Results" folder. However, if you want to run scrpts 1 and 2 with our data, please, contact the authors. 

In the "Results" folder are the secondary files, i.e. the files generated by the R code. These files are organized in subfolders to help with the data organization. 

CODE FILE EXPLANATION: 

We recommend first reading the associated publication to understand the data analysis. Reading the comments in the code files should go a long way toward helping understand the dataset and code logic. If you have any questions please contact us.

CODE FILE DESCRIPTION:
 
01-Profile_niche_occupancy.R: This code uses the environmental layers and ecological niche models to generate the profile niche occupancy (pno) for each species.  
 
02-Niche-similarity_and_age_correlation.R: This code uses de pno files generated in the first script to calculate  D and I niche similarity metrics. This code also compute the age range correlation (ARC) taking into account the phylogeny data available in the "data" folder. 

03-Life_form_ancestral_reconstruction-corHMM.R: This code uses phylogenetic trees and the life form classification file to choose de best evolution model (corHMM analysis) and run the stochastic character mapping (SIMMAP).

04-OUwie_models.R: This code uses the SIMMAP and pno files to fit seven different evolution models in the data. 

05-WN_models.R:This code uses the SIMMAP and pno files to fit the white noise model (null model) in the data.

06A-Bio17-model_selection.R:  This code checks the plausibility of the model of bio 17 by analyzing the eingeValues and checking if the theta estimated value makes biological sense. This code also makes a table with the AICC and Delta AICc values of all plausible models and counts which models obtained the best fit.

06B-Bio18-model_selection.R:  This code checks the plausibility of the model of bio 18 by analyzing the eingeValues and checking if the theta estimated value makes biological sense. This code also makes a table with the AICC and Delta AICc values of all plausible models and counts which models obtained the best fit. This code also select the best fitting models and extracts the theta estimated values to build Figure 3.

06C-fire-model_selection.R:  This code checks the plausibility of the model of fire by analyzing the eingeValues and checking if the theta estimated value makes biological sense. This code also makes a table with the AICC and Delta AICc values of all plausible models and counts which models obtained the best fit. This code also select the best fitting models and extracts the theta estimated values to build Figure 3.

06D-nitro-model_selection.R:  This code checks the plausibility of the model of nitro by analyzing the eingeValues and checking if the theta estimated value makes biological sense. This code also makes a table with the AICC and Delta AICc values of all plausible models and counts which models obtained the best fit. This code also select the best fitting models and extracts the theta estimated values to build Figure 3.
